<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="10,000 Hours Pomodoro Timer - Track your path to mastery"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    
    <!-- GitHub Pages SPA support -->
    <script type="text/javascript">
      // Single Page Apps for GitHub Pages
      // MIT License
      // https://github.com/rafgraph/spa-github-pages
      (function(l) {
        if (l.search[1] === '/' ) {
          var decoded = l.search.slice(1).split('&').map(function(s) { 
            return s.replace(/~and~/g, '&')
          }).join('?');
          window.history.replaceState(null, null,
            l.pathname.slice(0, -1) + decoded + l.hash
          );
        }
      }(window.location))
    </script>
    
    <!-- Enhanced script to disable security timers and prevent auto-clicks -->
    <script>
      (function() {
        // Function to remove security messages and prevent auto-clicks
        window.addEventListener('DOMContentLoaded', function() {
          // Initial protection before components load
          var originalClick = Element.prototype.click;
          Element.prototype.click = function() {
            console.log('Click intercepted - checking if legitimate');
            // Block programmatic clicks on buttons and inputs in auth forms
            if (this.tagName === 'BUTTON' || this.tagName === 'INPUT') {
              var isInAuthForm = false;
              var parent = this;
              
              // Check if element is in an auth form/modal
              while (parent && parent !== document) {
                if (parent.className && 
                    (parent.className.includes('modal') || 
                     parent.className.includes('form'))) {
                  isInAuthForm = true;
                  break;
                }
                parent = parent.parentElement;
              }
              
              // Block auto-clicks in auth forms
              if (isInAuthForm) {
                console.log('Blocked auto-click in auth form');
                return false;
              }
            }
            
            // Allow legitimate clicks to proceed
            return originalClick.apply(this, arguments);
          };
          
          // Regular security message removal
          setInterval(function() {
            try {
              // Remove security messages
              var elements = document.querySelectorAll('div');
              for (var i = 0; i < elements.length; i++) {
                var el = elements[i];
                if (el && el.textContent && (
                  el.textContent.indexOf('For security purposes') !== -1 || 
                  el.textContent.indexOf('after 46 seconds') !== -1
                )) {
                  el.style.display = 'none';
                }
              }
              
              // Remove any injected click triggers
              var suspiciousScripts = document.querySelectorAll('script:not([src])');
              for (var j = 0; j < suspiciousScripts.length; j++) {
                var script = suspiciousScripts[j];
                if (script.textContent && (
                  script.textContent.indexOf('click()') !== -1 ||
                  script.textContent.indexOf('submit()') !== -1
                )) {
                  script.textContent = '/* Neutralized */';
                }
              }
            } catch (e) {
              // Ignore errors
            }
          }, 100);
        });
      })();
    </script>
    
    <title>10,000 Hours - Pomodoro Timer</title>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    
    <div class="hidden">
      <audio src="%PUBLIC_URL%/backtowork.mp3" data-sound="pomodoro"></audio>
      <audio src="%PUBLIC_URL%/break.mp3" data-sound="shortBreak"></audio>
      <audio src="%PUBLIC_URL%/break.mp3" data-sound="longBreak"></audio>
    </div>

    <script>
      // Error logging to diagnose UI issues
      window.addEventListener('error', function(e) {
        console.error('Global error caught:', e.error);
        // Display error directly on screen for debugging
        var errorDiv = document.createElement('div');
        errorDiv.style.position = 'fixed';
        errorDiv.style.top = '10px';
        errorDiv.style.left = '10px';
        errorDiv.style.backgroundColor = 'rgba(255,0,0,0.8)';
        errorDiv.style.color = 'white';
        errorDiv.style.padding = '10px';
        errorDiv.style.zIndex = '9999';
        errorDiv.textContent = 'Error: ' + (e.error ? e.error.message : e.message);
        document.body.appendChild(errorDiv);
      });
    </script>
  </body>
</html> 